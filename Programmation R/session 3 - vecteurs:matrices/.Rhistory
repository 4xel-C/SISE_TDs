# ------------------------ Exercice 2
x <- c(185,159,170,168,190,167,160,179,176,155)
y <- as.factor (c("h", "f", "f", "h", "f", "f", "f", "h", "h", "f"))
x
y
x[y == "h"]
test_student_vectors_manipulations <- function(x, y) {
if (!is.factor(y) | !length(unique(y))) {
stop("y n'est pas un factor ou ne contient pas le bon nombre de facteurs")
}
# Scinder les valeurs en deux groupes.
x_hommes <- x[y == "h"]
x_femmes <- x[y == "f"]
return(comp.moyenne(x_hommes, x_femmes))
}
test_student_vectors_manipulations(x, y)
# ------------------------ Exercice 1
comp.moyenne <- function(v1, v2) {
# Calcul des moyennes
m1 <- mean(v1)
m2 <- mean(v2)
# Calcul des variances
s1 <- sd(v1) **2
s2 <- sd(v2) **2
# Calcul du nombre d'éléments
n1 <- length(v1)
n2 <- length(v2)
# Calcul de la variance totale.
var <- ((n1-1) * s1 + (n2 - 1) * s2) / (n1 + n2 - 2)
# Calcul du t de student.
t <- (m1 - m2) / (sqrt(var) * sqrt((1/n1) + (1/n2)))
# Calcul de la pvalue.
p.value <- 2 * pt(abs(t), (n1 + n2 - 2), lower.tail = FALSE)
ddl <- n1 + n2 - 2
# Renvoyer une liste
return(list(t = t, p.value = p.value, ddl = ddl))
}
# ------------------------ Exercice 2
x <- c(185,159,170,168,190,167,160,179,176,155)
y <- as.factor (c("h", "f", "f", "h", "f", "f", "f", "h", "h", "f"))
test_student_vectors_manipulations <- function(x, y) {
if (!is.factor(y) | !length(unique(y))) {
stop("y n'est pas un factor ou ne contient pas le bon nombre de facteurs")
}
# Scinder les valeurs en deux groupes.
x_hommes <- x[y == "h"]
x_femmes <- x[y == "f"]
return(comp.moyenne(x_hommes, x_femmes))
}
test_student_vectors_manipulations(x, y)
# ------------------------ Exercice 9
A <- c(185,168,179,176)
B <- c(159,170,190,167,160,155)
A
rank(A)
rank(c(A, B))
names(A) <- "A"
A
names(A) <- rep("A", times(length(A))
)
names(A) <- rep("A", times = length(A))
A
rank(c(A, B))
names(B) <- rep("B", times = length(B))
a
A
B
test <- rank(c(A,B))
test
test[A]
test[names(test) == "A"]
